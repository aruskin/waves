italic.text
doc.text[which(doc.text %in% italic.text)]
length(doc.text[which(doc.text %in% italic.text)])
italic.tex[23]
italic.text[23]
italic.text[24]
italic.text[25]
italic.text[30]
italic.text[31]
italic.text[31:35]
italic.text[31] <- patse(italic.text[31:35])
italic.text[31] <- paste(italic.text[31:35])
italic.text[31]
italic.text[32]
paste(italic.text[31:35])
paste(italic.text[31:35], collapse="")
paste(italic.text[31:35], collapse=" ")
italic.text[31] <- paste(italic.text[31:35], collapse=" ")
italic.text[32:35] <- NA
length(doc.text[which(doc.text %in% italic.text)])
bad.lines <- which(doc.text == doc.text[1])
waves.text <- doc.text[-bad.lines]
head(waves.text)
waves.text <- waves.text[2:length(waves.text)]
tail(waves.text)
waves.text <- waves.text[1:(length(waves.text)-2)]
library(stringr)
name_locs <- str_locate(pattern = "\' said [A-Z][a-z]*[:punct:]", waves.text)
id <- sapply(1:length(waves.text),
function(i) substr(waves.text[i],
name_locs[i, 1],
name_locs[i, 2])) %>%
gsub("\' said ", "", .) %>%
gsub("[[:punct:]]", "", .)
waves.passages <- which(waves.text %in% italic.text)
id[waves.passages] <- "WAVES"
curr.speaker <- "WAVES"
for(i in 1:length(id)){
if(!is.na(id[i])) curr.speaker <- id[i]
else id[i] <- curr.speaker
}
id
waves.text <- gsub("\' said [A-Z][a-z]*[[:punc:]]", " ", waves.text)
waves.text <- gsub("\' said [A-Z][a-z]*[[:punct:]]", " ", waves.text)
head(waves.text)
waves.text <- gsub("\' said [A-Z][a-z]*[[:punct:]][\']*", " ", waves.text)
library(tokenizers)
all.words <- lapply(waves.text, tokenize_words) %>% unlist %>% unique %>% sort
waves.text.words <- lapply(waves.text, tokenize_words) %>%
lapply(., table) %>%
lapply(., function(x) {
x <- as.data.frame(x)
rownames(x) <- x$Var1
x$Var1 <- NULL
as.data.frame(t(x))
}) %>%
rbind.fill
waves.text.words$speaker <- id
waves.text.words$id <- paste0(id, 1:length(id))
View(waves.text.words)
?rbind.fill
library(wordcloud)
install.packages("wordcloud")
install.packages("slam")
install.packages("installr")
install.packages("wordcount")
install.packages("wordcloud")
source('~/Coding Adventures/waves/1_preprocess_text.R')
install.packages("XML")
install.packages("dplyr")
install.packages("stringr")
source('~/Coding Adventures/waves/1_preprocess_text.R')
source('~/Coding Adventures/waves/1_preprocess_text.R')
install.packages("tokenizers")
source('~/Coding Adventures/waves/1_preprocess_text.R')
?rbind.fill
?rbind_all
?bind_rows
waves.text.words <- lapply(waves.text, tokenize_words) %>%
lapply(., table) %>%
lapply(., function(x) {
x <- as.data.frame(x)
rownames(x) <- x$Var1
x$Var1 <- NULL
as.data.frame(t(x))
}) %>%
bind_rows
View(waves.text.words)
waves.text.words$speaker <- id
waves.text.words$id <- paste0(id, 1:length(id))
library(wordcloud)
rhoda <- waves.text.words %>%
filter(speaker=="Rhoda")
?rowSums
rowSums(rhoda[1:5], na.rm=TRUE)
rowSums(rhoda[,1:5], na.rm=TRUE)
thoda[,1]
rhoda[,1]
rowSums(rhoda[,1:5], na.rm=FALSE)
rhoda[,1:2]
colSums(rhoda[,1:2])
colSums(rhoda[,1:2], na.rm = TRUE)
rhoda <- waves.text.words %>%
filter(speaker=="Rhoda") %>%
colSums(.[,1:(ncol(.)-2)])
rhoda <- waves.text.words %>%
filter(speaker=="Rhoda") %>%
colSums(x = .[,1:(ncol(.)-2)],
na.rm = TRUE)
tail(colnames(rhoda))
rhoda <- waves.text.words %>%
filter(speaker=="Rhoda") %>%
colSums(x = .[,1:(ncol(waves.text.words)-2)],
na.rm = TRUE)
(ncol(rhoda)-2)
oda <- waves.text.words %>%
filter(speaker=="Rhoda")
rhoda <- waves.text.words %>%
filter(speaker=="Rhoda")
rm(oda)
gc()
rhodaWords <- colSums(x = rhoda[,1:(ncol(rhoda)-2)],
na.rm = TRUE)
head(rhodaWords)
?wordcloud
wordcloud(words = colnames(rhodaWords),
freq = rhodaWords, min.freq = 10)
ordcloud(words = colnames(rhodaWords),
freq = rhodaWords, min.freq = 10)
wordcloud(words = colnames(rhodaWords),
freq = rhodaWords, min.freq = 10)
?wordcloud
wordcloud(words = colnames(rhodaWords),
freq = rhodaWords, min.freq = 10,
max.words = 100)
wordcloud(words = colnames(rhodaWords),
freq = rhodaWords)
head(colnames(rhodaWords))
names(rhodaWords)
wordcloud(words = names(rhodaWords),
freq = rhodaWords)
wordcloud(words = names(rhodaWords),
freq = rhodaWords,
min.freq = 10,
max.words = 100)
library(RColorBrewer)
pal <- brewer.pal(9,"BuGn")
wordcloud(words = names(rhodaWords),
freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
head(sort(thodaWords))
head(sort(rhodaWords))
head(sort(rhodaWords, decreasing = TRUE))
?stopwords
stopwords("en")
wordcloud(words = rhodaWords
#freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
#freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
wordcloud(words = rhodaWords,
#freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
install.packages("tm")
library(tm)
wordcloud(words = rhodaWords,
#freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
detach("package:tm", unload=TRUE)
mode(rhodaWords)
names(rhodaWords) %in% stopwords("en")
rhodaWords <- colSums(x = rhoda[,1:(ncol(rhoda)-2)],
na.rm = TRUE) %>%
.[!(names(.) %in% stopwords("en"))]
wordcloud(words = rhodaWords,
freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
wordcloud(words = names(rhodaWords),
freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
wordcloud(words = names(rhodaWords),
freq = rhodaWords,
min.freq = 10,
max.words = 100)
?wordcloud
pal <- brewer.pal(9,"BuGn")
pal <- pal[-(1:4)]
wordcloud(words = names(rhodaWords),
freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
?brewer.pal
display.brewer.pal(9, "BuGn")
display.brewer.pal(6, "BuGn")
pal <- brewer.pal(6,"BuGn") %>%
.[-(1:2)]
wordcloud(words = names(rhodaWords),
freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
wordcloud(words = names(rhodaWords),
freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
wordcloud(words = names(rhodaWords),
freq = rhodaWords,
min.freq = 10,
max.words = 50,
colors=pal)
wordcloud(words = names(rhodaWords),
freq = rhodaWords,
min.freq = 10,
max.words = 100,
colors=pal)
pal <- brewer.pal(6,"BuGn") %>%
.[-(1:3)]
wordcloud(words = names(rhodaWords), freq = rhodaWords, min.freq = 10,
max.words = 100, colors=pal)
pronouns <-c("i", "me", "my", "you", "your", "yours", "she", "her", "hers",
"he", "his", "him", "we", "our", "ours", "they", "their", "theirs")
rWordsNoNamesPronouns <- rhodaWords %>%
.[!(names(.) %in% c(pronouns, charNames)]
charNames <- c("bernard", "louis", "neville",
"jinny", "rhoda", "susan",
"percival")
pronouns <-c("i", "me", "my", "you", "your", "yours", "she", "her", "hers",
"he", "his", "him", "we", "our", "ours", "they", "their", "theirs")
rWordsNoNamesPronouns <- rhodaWords %>%
.[!(names(.) %in% c(pronouns, charNames))]
wordcloud(words = names(rWordsNoNamesPronouns), freq = rhodaWords, min.freq = 10,
max.words = 100, colors=pal)
wordcloud(words = names(rWordsNoNamesPronouns),
freq = rWordsNoNamesPronouns,
max.words = 100, colors=pal)
wordcloud(words = names(rhodaWords), freq = rhodaWords,
max.words = 100, colors=pal)
wordcloud(words = names(rWordsNoNamesPronouns),
freq = rWordsNoNamesPronouns,
max.words = 100, colors=pal)
pronouns <-c("i", "me", "my", "you", "your", "yours", "she", "her", "hers",
"he", "his", "him", "we", "our", "ours", "they", "their",
"theirs", "us", "them")
rWordsNoNamesPronouns <- rhodaWords %>%
.[!(names(.) %in% c(pronouns, charNames))]
wordcloud(words = names(rWordsNoNamesPronouns),
freq = rWordsNoNamesPronouns,
max.words = 100, colors=pal)
getCharacterCloud <- function(char.name, word.matrix, exclude, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
wordcloud(words = names(rhodaWords), freq = rhodaWords,
list(...))
}
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
wordcloud(words = names(rhodaWords), freq = rhodaWords,
list(...))
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.word.text)], max.words = 100)
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], max.words = 100)
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], max.words = 100)
?...
?`...`
?wordcloud
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
list(max.words = 100))
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)])
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(words = names(char.words), freq = char.words,
list(...))
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)])
stopwds <- tokenizers::stopwords("en")
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds)
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(words = names(char.words), freq = char.words,
max.words = 100)
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds)
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds, scale=c(8, .5))
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds, scale=c(8, 1))
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(words = names(char.words), freq = char.words,
max.words = 100, list(...))
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds, scale=c(8, 1))
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds)
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(words = names(char.words), freq = char.words,
max.words = 100, use.r.layout = TRUE)
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds)
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(words = names(char.words), freq = char.words,
scale=c(4, .5), list(...))
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds)
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds, list(max.words = 100, colors = pal))
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds, max.words = 100, colors = pal)
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, max.words, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(words = names(char.words), freq = char.words, list(...))
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds, 100)
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, max.words, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(words = names(char.words), freq = char.words, max.words = max.words,
list(...))
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)], stopwds, 100)
?wordcloud
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, max.words, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(names(char.words), char.words, c(8, .3),,max.words,
list(...))
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
stopwds, 100)
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, max.words, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(names(char.words), char.words, c(8, .3),3,max.words,
list(...))
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
stopwds, 100)
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, max.words, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(names(char.words), char.words, c(8, .3),3,max.words)
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
stopwds, 100)
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL, max.words, ...){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(names(char.words), char.words, c(8, .5),3,max.words)
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
stopwds, 100)
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL,
max.words=100, colors="black"){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(names(char.words), char.words, c(8, .5), 3,max.words, colors=colors)
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
stopwds, 100, pal)
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), 100, pal)
warnings()
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL,
scale=c(8, .5), min.freq=3,
max.words=100, colors="black"){
char.rows <- word.matrix %>%
filter(speaker == char.name) %>%
select(-speaker)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
print(head(char.words))
wordcloud(names(char.words), char.words, scale, min.freq, max.words, colors=colors)
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
getCharacterCloud("Louis", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
getCharacterCloud("Susan", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
getCharacterCloud("Jinny", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
getCharacterCloud("Bernard", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
getwd()
setwd("~/Coding Adventures/waves")
savePlot(filename="Rhoda_cloud.png")
save.plot(filename="Rhoda_cloud.png")
?savePlot
getCharacterCloud <- function(char.name, word.matrix, exclude=NULL,
scale=c(8, .5), min.freq=3,
max.words=100, colors="black"){
char.rows <- word.matrix %>%
filter(SPEAKER == char.name) %>%
select(-SPEAKER)
char.words <- colSums(x = char.rows, na.rm=TRUE) %>%
.[!(names(.) %in% exclude)]
wordcloud(names(char.words), char.words, scale, min.freq, max.words,
random.order=FALSE, colors=colors)
}
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
waves.text.words$SPEAKER = waves.text.words$speaker
waves.text.words$speaker <- NULL
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
waves.text.words$id <- NULL
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
head(waves.text.words$SPEAKER)
library(dplyr)
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
getCharacterCloud("Rhoda", waves.text.words,
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
png("RhodaWordCloud_test.png")
getCharacterCloud("Rhoda", waves.text.words[-ncol(waves.text.words)],
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
getCharacterCloud("Rhoda", waves.text.words,
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
dev.off()
getCharacterCloud("Louis", waves.text.words,
c(stopwds, pronouns), scale=c(4, .5), max.words=100,
colors=pal)
